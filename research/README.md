# Тестирование производительности БД Mongo и Cassandra

## Условия тестирования


У каждой БД использовалась только одна нода. 

Тесты и обе БД запускаются в docker контейнирах со следующими ограничениями:

      cpus: '6'
      memory: 3G

## Запуск контейнеров

Контейнеры собраны на основе следующих образов:

- Mongo: mongo:6.0.5
- Cassandra: cassandra:4.1.1
- Тесты: python:3.11.2-slim

Запуск осуществляется следующей командой: 

```bash
docker-compose up -d --build
```

Результаты тестирования: 

```bash
docker-compose logs -f research
```

## Тестирование

Измеряется скорость выполнения следующих операций:

- Чтение N закладок
- Вычисление средней пользовательской оценки для N лайков и log<sub>1.001</sub>N фильмов
- Запись N лайков для log<sub>1.001</sub>N фильмов с последующим вычислением средней пользовательской оценки для сохраненного кинопроизведения

В каждом тестировании используются одинаковые наборы данных для Mongo и Cassandra. 

## Полученные результаты

20000 закладок и лайков:
```
Test reading 20000 bookmarks:
  cassandra: 0:00:26.985128, avg=0:00:00.001349, min=0:00:00.000459, max=0:00:00.017629
  mongo:     0:00:12.415719, avg=0:00:00.000621, min=0:00:00.000489, max=0:00:00.007102
Test average rating of 9908 films in 20000 likes:
  cassandra: 0:00:12.222031, avg=0:00:00.001234, min=0:00:00.000745, max=0:00:00.027714
  mongo:     0:00:08.281329, avg=0:00:00.000836, min=0:00:00.000662, max=0:00:00.001604
Test insert data and read average rating of 9908 films in 20000 likes:
  cassandra: 0:00:42.499667, avg=0:00:00.002125, min=0:00:00.001716, max=0:00:00.022814
  mongo:     0:00:27.032372, avg=0:00:00.001352, min=0:00:00.001147, max=0:00:00.018855
```

100000 закладок и лайков:
```
Test reading 100000 bookmarks:
  cassandra: 0:02:12.310172, avg=0:00:00.001323, min=0:00:00.000653, max=0:00:00.077458
  mongo:     0:01:02.053772, avg=0:00:00.000621, min=0:00:00.000223, max=0:00:00.019190
Test average rating of 11518 films in 100000 likes:
  cassandra: 0:00:14.106393, avg=0:00:00.001225, min=0:00:00.000950, max=0:00:00.027360
  mongo:     0:00:10.037273, avg=0:00:00.000871, min=0:00:00.000691, max=0:00:00.001796
Test insert data and read average rating of 11518 films in 100000 likes:
  cassandra: 0:03:37.425549, avg=0:00:00.002174, min=0:00:00.001651, max=0:00:00.999611
  mongo:     0:02:21.133744, avg=0:00:00.001411, min=0:00:00.000194, max=0:00:00.025510
```

## Заключение

Обе БД по средним значениям укладываются в требуемые 200 мс на операцию, при этом Mongo выглядит предпочтительней, т.к. лучше с операциями на чтение. 